<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TULLY'S COFFEE ビーンズ診断</title>
<style>
  :root{
    --bg:#000;
    --fg:#fff;
    --accent:#AE2573; /* AEONピンク系を指定されていたので参照 */
    --card:#111;
    --muted:#cfcfcf;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--fg);
    font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", Meiryo, Arial, sans-serif;
    line-height:1.6;
  }
  header{padding:26px 16px 8px; text-align:center}
  h1{
    margin:0; font-weight:800; line-height:1.15;
    font-size: clamp(28px, 5vw, 40px); /* 少し小さめに */
    letter-spacing:.02em;
  }
  h1 span{display:block}
  .sub{
    opacity:.8; font-size:.95rem; margin-top:8px;
  }

  main{max-width:980px; margin:0 auto; padding: 12px 16px 96px;}

  .card{
    background:var(--card); border:1px solid #222; border-radius:16px;
    padding:20px; box-shadow: 0 6px 24px rgba(0,0,0,.35);
  }

  .qno{font-weight:700; opacity:.85; margin-bottom:8px}
  .question{
    font-size: clamp(18px, 2.8vw, 22px); font-weight:700; margin:2px 0 18px;
  }
  .options{display:grid; gap:12px}
  .btn{
    width:100%; display:block; text-align:left; padding:14px 16px; border-radius:12px;
    border:1px solid #333; background:#0f0f0f; color:var(--fg); cursor:pointer; font-size:1rem;
    transition:.15s transform, .15s background, .15s border-color;
  }
  .btn:hover{transform:translateY(-1px); border-color:#444; background:#141414}
  .btn:active{transform:translateY(0)}

  .navs{display:flex; gap:10px; margin-top:18px; justify-content:space-between}
  .ghost{background:transparent; border-color:#333; opacity:.85}
  .primary{
    background:var(--accent); border-color:transparent; color:#fff; text-align:center;
    font-weight:700;
  }

  .progress{
    height:8px; background:#1b1b1b; border-radius:999px; overflow:hidden; margin:16px 0 22px;
    border:1px solid #262626;
  }
  .bar{height:100%; width:0; background:#444; transition: width .25s}
  .bar::after{
    content:""; display:block; height:100%; background:#fff; mix-blend-mode:screen; opacity:.6;
  }

  .hide{display:none}

  /* result */
  .result-title{
    font-size: clamp(26px, 4.6vw, 38px);
    font-weight:900; margin:0 0 8px; letter-spacing:.01em;
  }
  .bean-name{
    font-size: clamp(28px, 5.2vw, 44px); /* 最も太く大きく */
    font-weight:1000; line-height:1.15;
  }
  .desc{color:var(--muted); font-size:1.05rem}
  .grid{
    display:grid; gap:18px; grid-template-columns: 1fr; align-items:start;
  }
  .figure{
    background:#0a0a0a; border:1px solid #222; border-radius:14px; overflow:hidden;
  }
  .figure img{width:100%; height:280px; object-fit:cover; display:block}
  .tags{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
  .tag{border:1px solid #333; border-radius:999px; padding:.25rem .6rem; font-size:.85rem; color:#ddd}

  @media (min-width:840px){
    .grid{grid-template-columns: 420px 1fr;}
    .figure img{height:100%}
  }

  footer{
    position:fixed; right:10px; bottom:10px;
    background:#FF6FAE; /* 視認性の良いピンク */
    color:#fff; padding:6px 10px; border-radius:8px; font-weight:700; box-shadow:0 6px 20px rgba(0,0,0,.35);
    font-size: clamp(12px, 2vw, 14px);
  }

  a.inline{color:#9ecbff; text-decoration:none; border-bottom:1px dotted #9ecbff}
  .muted{color:#bdbdbd}
  .center{text-align:center}

  .top3{margin-top:18px; border-top:1px dashed #333; padding-top:14px}
  .top3 h3{margin:0 0 8px; font-size:1.05rem}
  .top3 ol{margin:0; padding-left:18px}
</style>
</head>
<body>
  <header>
    <h1>
      <span>TULLY'S COFFEE</span>
      <span>ビーンズ診断</span>
    </h1>
    <div class="sub">好みを選ぶだけ。最適な1杯をおすすめします。</div>
  </header>

  <main>
    <!-- 診断カード -->
    <section id="quiz" class="card">
      <div class="qno" id="qno"></div>
      <div class="question" id="question"></div>

      <div class="options" id="options"></div>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div class="navs">
        <button class="btn ghost" id="backBtn">戻る</button>
        <button class="btn primary" id="skipBtn">スキップ</button>
      </div>
    </section>

    <!-- 結果カード -->
    <section id="result" class="card hide">
      <div class="grid">
        <figure class="figure">
          <img id="beanImg" alt="">
        </figure>

        <div>
          <div class="result-title">あなたにおすすめの豆は</div>
          <div class="bean-name" id="beanName"></div>
          <p class="desc" id="beanDesc"></p>

          <div class="tags" id="beanTags"></div>

          <div class="top3" id="top3"></div>

          <div class="navs" style="margin-top:18px">
            <button class="btn ghost" onclick="restart()">はじめから</button>
            <a class="btn primary" id="shareBtn" href="#" download>結果を画像保存</a>
          </div>
          <p class="muted" style="margin-top:8px">※ 画像は端末の共有メニューから保存できます。</p>
        </div>
      </div>
    </section>
  </main>

  <footer>タリーズコーヒー　イオンモール筑紫野</footer>

<script>
/* =========================
 * データ定義
 * ========================= */
const BEANS = {
  house: {
    id: "house",
    name: "ハウスブレンド",
    desc: "ほどよい酸味とまろやかなコクが楽しめる、バランスの良い定番ブレンドです。毎日飲みたくなる、やさしい味わいです。",
    tags:["バランス","毎日飲みやすい","中煎り"],
    image:"./images/house.jpg"
  },
  brazil: {
    id: "brazil",
    name: "ブラジル ファゼンダ",
    desc: "ナッツのような香ばしさとコクのある甘みが特徴です。おやつと一緒に楽しみたくなる味わいです。",
    tags:["ナッツ系","甘み","中煎り〜中深煎り"],
    image:"./images/brazil.jpg"
  },
  black3: {
    id: "black3",
    name: "ブラックスリー",
    desc: "しっかりしたコクと甘み、香ばしさが絶妙なバランスです。ブラックで楽しみたい方にぴったりです。",
    tags:["力強い","ブラック向き","中深煎り〜深煎り"],
    image:"./images/black3.jpg"
  },
  piccolo: {
    id: "piccolo",
    name: "ピッコロバンビーノ",
    desc: "軽やかでマイルド、キャラメルのような香ばしさが特徴です。酸味も心地よく、すっきり飲めます。朝にピッタリ。",
    tags:["軽やか","マイルド","朝に◎"],
    image:"./images/piccolo.jpg"
  },
  french: {
    id: "french",
    name: "フレンチロースト",
    desc: "深煎りでスモーキーな香りとしっかりした苦味が魅力です。ビター派に人気の力強い味わいです。",
    tags:["深煎り","スモーキー","ビター"],
    image:"./images/french.jpg"
  },
  espresso: {
    id: "espresso",
    name: "エスプレッソクラシコ",
    desc: "ミルクとも相性の良い濃厚なコクと甘み。エスプレッソやラテに合うブレンドです。",
    tags:["ラテ向き","濃厚","中深煎り〜深煎り"],
    image:"./images/espresso.jpg"
  },
  mochajava: {
    id: "mochajava",
    name: "モカジャバ",
    desc: "カカオ感とやわらかな果実味の調和。コクと華やかさを両立したクラシックブレンド。",
    tags:["チョコ系","やさしい酸","中煎り"],
    image:"./images/mochajava.jpg"
  },
  cafemonale: {
    id: "cafemonale",
    name: "カフェモナーレ",
    desc: "なめらかな口当たりとやさしい甘み。毎日飲みやすい“やさしめ”のテイスト。",
    tags:["やさしい甘み","スムース","ライト〜中煎り"],
    image:"./images/cafemonale.jpg"
  },
  lamiinita: {
    id: "lamiinita",
    name: "コスタリカ ラミニータ",
    desc: "クリーンで明るい酸、オレンジのような爽やかさ。後味はすっきりと上品。",
    tags:["クリーン","シトラス","ライト〜中煎り"],
    image:"./images/laminita.jpg"
  },
  uraga: {
    id: "uraga",
    name: "エチオピア モカG1 ウラガ ナチュラル",
    desc: "ベリーのような華やかな香りとジューシーな果実味。香り重視の方におすすめ。",
    tags:["フルーティ","アロマ","ライト〜中煎り"],
    image:"./images/uraga.jpg"
  }
};

// 質問定義（各選択肢が特定の豆のスコアに重み付け）
const QUESTIONS = [
  {
    q: "どんな焙煎度が好き？",
    options: [
      {label:"ライト〜中煎り（軽やか）", score:{piccolo:1, lamiinita:2, uraga:2, house:1, cafemonale:1}},
      {label:"中煎り（バランス）", score:{house:2, brazil:1, mochajava:1, lamiinita:1}},
      {label:"中深煎り（コク重視）", score:{black3:2, espresso:2, brazil:1, house:1}},
      {label:"深煎り（ビター）", score:{french:3, black3:2, espresso:1}}
    ]
  },
  {
    q: "酸味の強さは？",
    options: [
      {label:"しっかり感じたい（明るい酸）", score:{uraga:3, lamiinita:2, house:1}},
      {label:"ほどほど（バランス）", score:{house:2, mochajava:1, piccolo:1}},
      {label:"弱めが好き", score:{brazil:2, black3:1, french:2, espresso:1}}
    ]
  },
  {
    q: "コク・ボディ感は？",
    options: [
      {label:"軽めでスッキリ", score:{piccolo:2, lamiinita:1, house:1}},
      {label:"中くらい（ちょうどよく）", score:{house:2, brazil:1, mochajava:1, cafemonale:1}},
      {label:"しっかり（重厚）", score:{black3:2, french:2, espresso:2}}
    ]
  },
  {
    q: "香りのタイプは？",
    options: [
      {label:"フルーティで華やか", score:{uraga:3, lamiinita:1, mochajava:1}},
      {label:"ナッツ/チョコ系の香ばしさ", score:{brazil:3, mochajava:2, black3:1}},
      {label:"スモーキー/ロースト感", score:{french:3, black3:1}}
    ]
  },
  {
    q: "飲み方は？",
    options: [
      {label:"ブラックで飲むことが多い", score:{black3:2, french:2, house:1, uraga:1}},
      {label:"ミルクと合わせる（ラテ等）", score:{espresso:3, mochajava:1, brazil:1}},
      {label:"どちらも同じくらい", score:{house:2, cafemonale:1}}
    ]
  },
  {
    q: "シーンを選ぶなら？",
    options: [
      {label:"朝、軽やかに", score:{piccolo:3, house:1}},
      {label:"仕事中にバランス良く", score:{house:2, brazil:1, cafemonale:1}},
      {label:"夜、ビターにじっくり", score:{french:3, black3:2}}
    ]
  },
  {
    q: "チャレンジ度合いは？",
    options: [
      {label:"定番・はずさない", score:{house:3, brazil:1, cafemonale:1}},
      {label:"少し個性がほしい", score:{mochajava:2, lamiinita:1, black3:1}},
      {label:"香りで驚きたい", score:{uraga:3}}
    ]
  }
];

/* =========================
 * ロジック
 * ========================= */
let current = 0;
const scores = {};
Object.keys(BEANS).forEach(k => scores[k]=0);

const els = {
  quiz: document.getElementById('quiz'),
  result: document.getElementById('result'),
  qno: document.getElementById('qno'),
  question: document.getElementById('question'),
  options: document.getElementById('options'),
  bar: document.getElementById('bar'),
  back: document.getElementById('backBtn'),
  skip: document.getElementById('skipBtn'),

  beanImg: document.getElementById('beanImg'),
  beanName: document.getElementById('beanName'),
  beanDesc: document.getElementById('beanDesc'),
  beanTags: document.getElementById('beanTags'),
  top3: document.getElementById('top3'),
  shareBtn: document.getElementById('shareBtn'),
};

function render(){
  const q = QUESTIONS[current];
  els.qno.textContent = `質問 ${current+1} / ${QUESTIONS.length}`;
  els.question.textContent = q.q;
  els.options.innerHTML = "";
  q.options.forEach((opt,i)=>{
    const b = document.createElement('button');
    b.className = 'btn';
    b.textContent = opt.label;
    b.onclick = ()=>{
      // スコア加点
      Object.entries(opt.score).forEach(([k,v])=> scores[k]+=v);
      next();
    };
    els.options.appendChild(b);
  });
  els.back.disabled = current===0;
  els.bar.style.width = `${(current)/QUESTIONS.length*100}%`;
}

function next(){
  if(current < QUESTIONS.length-1){
    current++;
    render();
  }else{
    // 最終質問の進捗を満タンに
    els.bar.style.width = `100%`;
    showResult();
  }
}

els.back.onclick = ()=>{
  if(current===0) return;
  current--;
  render();
};
els.skip.onclick = next;

function showResult(){
  // スコアの高い順にソート
  const ranked = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
  const top = BEANS[ranked[0][0]];

  // メイン
  els.beanName.textContent = top.name;
  els.beanDesc.textContent = top.desc;
  els.beanImg.src = top.image;
  els.beanImg.alt = top.name;

  els.beanTags.innerHTML = "";
  top.tags.forEach(t=>{
    const s=document.createElement('span'); s.className='tag'; s.textContent=t;
    els.beanTags.appendChild(s);
  });

  // Top3
  const top3 = ranked.slice(0,3).map(([k,sc])=>({bean:BEANS[k], score:sc}));
  const wrap = document.createElement('div');
  const h = document.createElement('h3'); h.textContent="近い味わいの候補";
  const ol = document.createElement('ol');
  top3.forEach((x,i)=>{
    const li=document.createElement('li');
    li.innerHTML = `<strong>${x.bean.name}</strong> <span class="muted">（スコア ${x.score}）</span>`;
    ol.appendChild(li);
  });
  wrap.append(h,ol);
  els.top3.innerHTML=""; els.top3.appendChild(wrap);

  // 共有（簡易的：結果名をPNGテキストにしてダウンロード）
  els.shareBtn.onclick = (e)=>{
    e.preventDefault();
    const txt = `おすすめ: ${top.name}\n\n${top.desc}\n\n#TullysBeans`;
    const blob = new Blob([txt], {type:"text/plain"});
    const url = URL.createObjectURL(blob);
    els.shareBtn.href = url;
    els.shareBtn.download = "beans_result.txt";
    // a要素のhrefを差し替えたらそのままクリックでDL
    setTimeout(()=>URL.revokeObjectURL(url), 5000);
  };

  // 画面切替
  els.quiz.classList.add('hide');
  els.result.classList.remove('hide');
}

function restart(){
  // 状態初期化
  current = 0;
  Object.keys(scores).forEach(k => scores[k]=0);
  els.result.classList.add('hide');
  els.quiz.classList.remove('hide');
  els.bar.style.width = "0%";
  render();
}

// 初期表示
render();
</script>
</body>
</html>
